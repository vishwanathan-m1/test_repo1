pipeline{

// agent any

agent {
  label 'agent1'
} 

// agent {
//   label '!agent1'
// } 


environment{
  PROJECT_NAME = "Volt MX Document"
}

  // options{
  //     buildDiscarder(logRotator(numToKeepStr: "10"))    
  // }

  stages{
      stage('Build'){
        steps{
          //error "Build Failed Testing"
          // echo "volt-mx-doc-opnsrc - repository is clonned from git scm to local"
          // echo "workspace used in this job is: ${env.WORKSPACE}"
          // sh "echo present working directory"
          // sh "pwd"
          sh "git status"
          // echo "checkout to master branch"
          //sh "git checkout master"
          //sh "git status"
          //sh "git fetch origin master"
          //sh "git pull origin master"
           
          // echo "changing to source directory.."
          // dir("${env.WORKSPACE}/source"){
          //     sh "pwd"
          //     sh "git status"
          //     sh "ruby -v"
          //     sh "which ruby"
          //     sh "echo Building VoltMX Docs Site.."
          //     //sh "sh buildDocs.sh" 
          //     echo "Build completed Successfully"
          // }
          //echo "copying files from _site to docs folder.."
          //sh "cp -R ${WORKSPACE}/source/_site/*  ${WORKSPACE}/docs"
          //echo "files Successfully copied to target location.."
         // echo "Committing the Changes..."
          //sh('git add .')
          //sh('git commit -am "Master Full Build"')
          //sh('git pull origin master')
          //sh('git push origin master')
          //emailext attachLog: true, body: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}: Check console output at ${env.BUILD_URL} to view the results.", replyTo: 'vishwanathan.m@hcl.com', subject: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}!", to: 'vishwanathan.m@hcl.com'
        }
      }
  
  }
  post {
        success{
            echo "Build result is ${currentBuild.currentResult} !"
        }
        failure{
            echo "Build result is ${currentBuild.currentResult}. Please check the console logs to re-run the build"
        }
        always{
          echo " ----------- Build Details ----------- "
          echo "Build Number: ${env.BUILD_NUMBER}"
          echo "Build Result: ${currentBuild.currentResult}"
          // emailext attachLog: true, body: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}: Check console output at ${env.BUILD_URL} to view the results.", replyTo: 'vishwanathan.m@hcl.com', subject: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}!", to: 'vishwanathan.m@hcl.com'
          emailext attachLog: true, body: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}. Please check the attached build logs and output to view the results in detail.", replyTo: 'vishwanathan.m@hcl.com', subject: "${env.PROJECT_NAME} - Build # ${env.BUILD_NUMBER} - ${currentBuild.currentResult}!", to: 'vishwanathan.m@hcl.com'
        }
    }


}
